---
import BaseLayout from "./BaseLayout.astro";
import { Image } from "astro:assets";
import { getTagLink } from "../utils/links";
const { frontmatter } = Astro.props;

// 格式化时间为 YYYY/MM/DD hh:mm:ss
const formatDate = (date: Date) => {
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, "0");
  const day = String(date.getDate()).padStart(2, "0");
  const hours = String(date.getHours()).padStart(2, "0");
  const minutes = String(date.getMinutes()).padStart(2, "0");
  const seconds = String(date.getSeconds()).padStart(2, "0");
  return `${year}/${month}/${day} ${hours}:${minutes}:${seconds}`;
};
---

<BaseLayout pageTitle={frontmatter.title}>
  {
    frontmatter.image && (
      <figure style="margin: 1.5rem 0;">
        <Image
          src={frontmatter.image.url}
          alt={frontmatter.image.alt}
          style="max-width: 100%; border-radius: 8px; height: auto;"
          width={1200}
          height={630}
        />
        {frontmatter.image.alt && (
          <figcaption style="text-align: center; color: #666; margin-top: 0.5rem;">
            {frontmatter.image.alt}
          </figcaption>
        )}
      </figure>
    )
  }

  <p><strong>发布时间：</strong>{formatDate(frontmatter.pubDate)}</p>
  <p><strong>作者：</strong>{frontmatter.author}</p>
  {
    frontmatter.description && (
      <p>
        <strong>描述：</strong>
        {frontmatter.description}
      </p>
    )
  }
  {
    frontmatter.tags && (
      <div class="tags-container">
        <strong>标签：</strong>
        {frontmatter.tags.map((tag: string) => (
          <a href={getTagLink(tag)} class="tag-link">
            {tag}
          </a>
        ))}
      </div>
    )
  }
  <hr style="margin: 1.5rem 0;" />
  <slot />
</BaseLayout>

<style>
  .tags-container {
    margin: var(--spacing-md) 0;
  }

  .tag-link {
    display: inline-block;
    margin-right: var(--spacing-sm);
    padding: 0.25rem var(--spacing-sm);
    background-color: var(--color-bg-tertiary);
    border-radius: var(--radius-sm);
    font-size: 0.9rem;
    text-decoration: none;
    color: var(--color-primary);
    transition: background-color var(--transition-fast);
  }

  .tag-link:hover {
    background-color: var(--color-border-primary);
  }

  :global(html.dark) figcaption {
    color: var(--color-text-tertiary) !important;
  }
</style>
