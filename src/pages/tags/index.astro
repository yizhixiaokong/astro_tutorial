---
import BaseLayout from "../../layouts/BaseLayout.astro";
const allPosts = Object.values(
  import.meta.glob("../../pages/posts/*.md", { eager: true })
);
const tags = [
  ...new Set(allPosts.map((post: any) => post.frontmatter.tags).flat()),
];
const pageTitle = "标签索引";
---

<BaseLayout pageTitle={pageTitle}>
  <p>本站共有 <strong>{tags.length}</strong> 个标签，用于分类和快速查找相关文章。</p>
  <div class="tags">
    {
      tags.map((tag) => {
        const count = allPosts.filter((post: any) =>
          post.frontmatter.tags.includes(tag)
        ).length;
        return (
          <a href={`/tags/${tag}`} class="tag">
            {tag} <span class="count">({count})</span>
          </a>
        );
      })
    }
  </div>
</BaseLayout>

<style>
  a {
    color: var(--color-primary);
  }

  .tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-md);
  }

  .tag {
    text-decoration: none;
    color: var(--color-primary);
    font-size: 1.1em;
    transition: color var(--transition-fast);
  }

  .tag:hover {
    color: var(--color-primary-hover);
    text-decoration: underline;
  }

  .count {
    font-size: 0.9em;
    color: var(--color-text-tertiary);
  }
</style>
